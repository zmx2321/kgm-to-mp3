(function(t){function e(e){for(var n,c,s=e[0],o=e[1],u=e[2],d=0,f=[];d<s.length;d++)c=s[d],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&f.push(i[c][0]),i[c]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],n=!0,s=1;s<r.length;s++){var o=r[s];0!==i[o]&&(n=!1)}n&&(a.splice(e--,1),t=c(c.s=r[0]))}return t}var n={},i={app:0},a=[];function c(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=t,c.c=n,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(r,n,function(e){return t[e]}.bind(null,n));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=o;a.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("cd49")},"0ba7":function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));r("d3b7"),r("ace4"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("986a"),r("1d02"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("6ce5"),r("2834"),r("72f7"),r("4ea1"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494");var n=r("9ab4"),i=r("cc74"),a=r("cb96");function c(t,e,r,c){return void 0===c&&(c=!0),Object(n["a"])(this,void 0,Promise,(function(){var s,o,u,l,d,f,b;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return s=r,c?(u=Uint8Array.bind,[4,Object(i["c"])(t)]):[3,2];case 1:o=new(u.apply(Uint8Array,[void 0,n.sent()])),s=Object(i["i"])(o,r),s!==r&&(t=new Blob([o],{type:i["a"][s]})),n.label=2;case 2:return[4,Object(a["parseBlob"])(t)];case 3:return l=n.sent(),d=Object(i["f"])(e,l.common.title,String(l.common.artists||l.common.artist||"")),f=d.title,b=d.artist,[2,{title:f,artist:b,ext:s,album:l.common.album,picture:Object(i["d"])(l),file:URL.createObjectURL(t),blob:t,mime:i["a"][s]}]}}))}))}},"0f92":function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return l}));r("d3b7"),r("a15b"),r("d81d"),r("ac1f"),r("1276"),r("b0c0"),r("14d9");var n=r("9ab4"),i=r("cb96"),a=r("acf9"),c=r.n(a),s=r("cc74"),o=r("97e5"),u=function(e){return c.a.decode(new t(e||""),"gbk")};function l(t,e,r,a){return Object(n["a"])(this,void 0,Promise,(function(){var c,o,l,m,p;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(i["parseBlob"])(t)];case 1:for(o in c=n.sent(),c.native)c.native.hasOwnProperty(o)&&c.native[o].some((function(t){return"TCON"===t.id&&"(12)"===t.value}))&&(console.warn("try using gbk encoding to decode meta"),c.common.artist="",c.common.artists?c.common.artist=c.common.artists.map(u).join():c.common.artist=u(c.common.artist),c.common.title=u(c.common.title),c.common.album=u(c.common.album));if(a&&"0"!==a)try{return[2,d(a,r,c,t)]}catch(v){console.warn("在线获取曲目信息失败，回退到本地 meta 提取",v)}return l=Object(s["f"])(e,c.common.title,c.common.artist),l.artist=l.artist||"",m=Object(s["d"])(c),m?[3,3]:[4,f(l.title,l.artist,c.common.album)];case 2:m=n.sent(),n.label=3;case 3:return p={title:l.title,artist:l.artist,album:c.common.album||"",imgUrl:m},[4,b({title:l.title,artists:l.artist.split(s["m"]),ext:r,imageURL:m,musicMeta:c,blob:t})];case 4:return[2,(p.blob=n.sent(),p)]}}))}))}function d(t,e,r,i){return Object(n["a"])(this,void 0,Promise,(function(){var a,c,s,u;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(o["d"])(t)];case 1:return a=n.sent(),c=Object(o["b"])(a.track_info.album.pmid),s=a.track_info.singer.map((function(t){return t.name})),u={title:a.track_info.title,artist:s.join(","),album:a.track_info.album.name,imgUrl:c},[4,b({title:a.track_info.title,artists:s,ext:e,imageURL:c,musicMeta:r,blob:i})];case 2:return[2,(u.blob=n.sent(),u)]}}))}))}function f(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(o["c"])(t,e,r)];case 1:return i=n.sent(),[2,Object(o["b"])(i.Id,i.Type)];case 2:return a=n.sent(),console.warn(a),[3,3];case 3:return[2,""]}}))}))}function b(e){return Object(n["a"])(this,void 0,Promise,(function(){var r,i,a,c,o,u,l;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,Object(s["e"])(e.imageURL)];case 1:return r=n.sent(),r||console.warn("获取图像失败"),i={picture:null===r||void 0===r?void 0:r.buffer,title:e.title,artists:e.artists},o=(c=t).from,[4,e.blob.arrayBuffer()];case 2:return a=o.apply(c,[n.sent()]),u=s["a"][e.ext]||s["a"].mp3,"mp3"===e.ext?[2,new Blob([Object(s["l"])(a,i,e.musicMeta)],{type:u})]:"flac"===e.ext?[2,new Blob([Object(s["k"])(a,i,e.musicMeta)],{type:u})]:(console.info("writing metadata for "+e.ext+" is not being supported for now"),[3,4]);case 3:return l=n.sent(),console.warn("Error while appending cover image to file "+l),[3,4];case 4:return[2,e.blob]}}))}))}}).call(this,r("1c35").Buffer)},1:function(t,e){},1813:function(t,e,r){},2:function(t,e){},"2e83":function(t,e,r){t.exports=r.p+"js/0.e281141d.worker.js"},3:function(t,e){},4:function(t,e){},"4bc5":function(t,e,r){"use strict";(function(t){var n=r("c7eb"),i=r("1da1"),a=(r("99af"),r("b0c0"),r("7327")),c=r("731b"),s=r("25f1"),o=r("507a"),u=r("73ec"),l=r("b7c7");e["a"]={name:"FileSelector",data:function(){return{task_all:0,task_finished:0,queue:new u["a"],parallel:!1}},computed:{progress_value:function(){return this.task_all?this.task_finished/this.task_all*100:0},progress_show:function(){return this.task_all!==this.task_finished}},mounted:function(){window.Worker&&"file:"!==window.location.protocol?(console.log("Using Worker Pool"),this.queue=Object(a["a"])((function(){return Object(c["a"])(new s["a"](t))}),navigator.hardwareConcurrency||1),this.parallel=!0):console.log("Using Queue in Main Thread")},methods:{progress_string:function(){return"".concat(this.task_finished," / ").concat(this.task_all)},addFile:function(t){var e=this;return Object(i["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.task_all++,e.queue.queue(Object(i["a"])(Object(n["a"])().mark((function r(){var i,a=arguments;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=a.length>0&&void 0!==a[0]?a[0]:o["a"],console.log("start handling",t.name),r.prev=2,r.t0=e,r.t1=i,r.t2=t,r.next=8,l["a"].getAll();case 8:return r.t3=r.sent,r.next=11,(0,r.t1)(r.t2,r.t3);case 11:r.t4=r.sent,r.t0.$emit.call(r.t0,"success",r.t4),r.next=19;break;case 15:r.prev=15,r.t5=r["catch"](2),console.error(r.t5),e.$emit("error",r.t5,t.name);case 19:return r.prev=19,e.task_finished++,r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[2,15,19,22]])}))));case 2:case"end":return r.stop()}}),r)})))()}}}}).call(this,r("2e83"))},5:function(t,e){},"507a":function(t,e,r){"use strict";r.d(e,"a",(function(){return V}));r("d3b7"),r("b0c0");var n=r("9ab4"),i=r("9b2d"),a=r("6d95"),c=(r("ace4"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("986a"),r("1d02"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("6ce5"),r("2834"),r("72f7"),r("4ea1"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494"),r("cc74")),s=r("cb96");function o(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,o,u,l,d,f,b,m;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return a=Uint8Array.bind,[4,Object(c["c"])(t)];case 1:for(i=new(a.apply(Uint8Array,[void 0,n.sent()])),o=i.length,u=0;u<o;u++)i[u]^=163;return l=Object(c["i"])(i,r),l!==r&&(t=new Blob([i],{type:c["a"][l]})),[4,Object(s["parseBlob"])(t)];case 2:return d=n.sent(),f=Object(c["f"])(e,d.common.title,String(d.common.artists||d.common.artist||"")),b=f.title,m=f.artist,[2,{title:b,artist:m,ext:l,album:d.common.album,picture:Object(c["d"])(d),file:URL.createObjectURL(t),blob:t,mime:c["a"][l]}]}}))}))}r("fb6a"),r("d9e2");var u=r("0ba7"),l=[105,102,109,116],d=[254,254,254,254],f={" WAV":".wav",FLAC:".flac"," MP3":".mp3"," A4M":".m4a"};function b(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,o,b,m,p,v,h,g,w,j,y,O,x,_;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return a=Uint8Array.bind,[4,Object(c["c"])(t)];case 1:if(i=new(a.apply(Uint8Array,[void 0,n.sent()])),Object(c["b"])(i,l)&&Object(c["b"])(i.slice(8,12),d))return[3,4];if("xm"!==r)return[3,2];throw Error("此xm文件已损坏");case 2:return[4,Object(u["a"])(t,e,r,!0)];case 3:return[2,n.sent()];case 4:if(o=(new TextDecoder).decode(i.slice(4,8)),!f.hasOwnProperty(o))throw Error("未知的.xm文件类型");for(b=i[15],m=i[12]|i[13]<<8|i[14]<<16,p=i.slice(16),v=p.length,h=m;h<v;++h)p[h]=p[h]-b^255;return g=f[o],w=c["a"][g],j=new Blob([p],{type:w}),[4,Object(s["parseBlob"])(j)];case 5:return y=n.sent(),"wav"===g&&(console.info(y.common),y.common.album="",y.common.artist="",y.common.title=""),O=Object(c["f"])(e,y.common.title,String(y.common.artists||y.common.artist||""),-1===e.indexOf("_")?"-":"_"),x=O.title,_=O.artist,[2,{title:x,artist:_,ext:g,mime:w,album:y.common.album,picture:Object(c["d"])(y),file:URL.createObjectURL(j),blob:j,rawExt:"xm"}]}}))}))}r("6c57"),r("14d9");var m=r("656c"),p=r.n(m);r("159b");function v(t){var e=0;t.forEach((function(t){e+=t.length}));var r=new Uint8Array(e),n=0;return t.forEach((function(t){r.set(t,n),n+=t.length})),r}var h=2097152;function g(t,e){return Object(n["a"])(this,void 0,Promise,(function(){var r,i,a,c,s,o,u,l,d,f,b,m;return Object(n["c"])(this,(function(n){switch(n.label){case 0:r={success:!1,data:new Uint8Array,songId:0,error:""},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,p()()];case 2:return i=n.sent(),[3,4];case 3:return a=n.sent(),r.error=(null===a||void 0===a?void 0:a.message)||"wasm 加载失败",[2,r];case 4:if(!i)return r.error="wasm 加载失败",[2,r];if(c=new Uint8Array(t),s=i._malloc(h),o=Math.min(h,t.byteLength),i.writeArrayToMemory(c.slice(-o),s),e="."+e,u=i.preDec(s,o,e),-1==u)return r.error=i.getErr(),[2,r];r.songId=i.getSongId(),r.songId="0"==r.songId?0:r.songId,l=[],d=0,f=c.length-u;while(f>0)b=Math.min(f,h),m=new Uint8Array(c.slice(d,d+b)),i.writeArrayToMemory(m,s),l.push(i.HEAPU8.slice(s,s+i.decBlob(s,b,d))),d+=b,f-=b;return i._free(s),r.data=v(l),r.success=!0,[2,r]}}))}))}var w=r("0f92"),j={mgg:{ext:"ogg",version:2},mgg0:{ext:"ogg",version:2},mggl:{ext:"ogg",version:2},mgg1:{ext:"ogg",version:2},mflac:{ext:"flac",version:2},mflac0:{ext:"flac",version:2},mmp4:{ext:"mp4",version:2},qmcflac:{ext:"flac",version:2},qmcogg:{ext:"ogg",version:2},qmc0:{ext:"mp3",version:2},qmc2:{ext:"ogg",version:2},qmc3:{ext:"mp3",version:2},qmc4:{ext:"ogg",version:2},qmc6:{ext:"ogg",version:2},qmc8:{ext:"ogg",version:2},bkcmp3:{ext:"mp3",version:1},bkcm4a:{ext:"m4a",version:1},bkcflac:{ext:"flac",version:1},bkcwav:{ext:"wav",version:1},bkcape:{ext:"ape",version:1},bkcogg:{ext:"ogg",version:1},bkcwma:{ext:"wma",version:1},tkm:{ext:"m4a",version:1},"666c6163":{ext:"flac",version:1},"6d7033":{ext:"mp3",version:1},"6f6767":{ext:"ogg",version:1},"6d3461":{ext:"m4a",version:1},776176:{ext:"wav",version:1}};function y(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,s,o,u,l,d,f,b,m,p,v,h,y;return Object(n["c"])(this,(function(n){switch(n.label){case 0:if(!(r in j))throw"Qmc cannot handle type: ".concat(r);return i=j[r],a=i.version,[4,Object(c["c"])(t)];case 1:return s=n.sent(),o=new Uint8Array,2===a&&globalThis.WebAssembly?[4,g(s,r)]:[3,3];case 2:if(l=n.sent(),!l.success)throw new Error(l.error||"(unknown error)");o=l.data,u=l.songId,console.log("qmc wasm decoder suceeded"),n.label=3;case 3:return d=Object(c["i"])(o,i.ext),f=c["a"][d],[4,Object(w["a"])(new Blob([o],{type:f}),e,d,u)];case 4:return b=n.sent(),m=b.album,p=b.artist,v=b.imgUrl,h=b.blob,y=b.title,[2,{title:y,artist:p,ext:d,album:m,picture:v,file:URL.createObjectURL(h),blob:h,mime:f}]}}))}))}function O(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,o,u,l,d,f,b,m,p;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(c["c"])(t)];case 1:return i=n.sent(),a=new Uint8Array,globalThis.WebAssembly?(console.log("qmc: using wasm decoder"),[4,g(i,r)]):[3,3];case 2:if(o=n.sent(),!o.success)throw new Error(o.error||"(unknown error)");a=o.data,console.log("qmc wasm decoder suceeded"),n.label=3;case 3:if(u=Object(c["i"])(a,""),l=Object(c["j"])(e),""===u&&"mp3"!==l.ext){if(l.ext in j)return d=new Blob([a],{type:"application/octet-stream"}),[2,y(d,l.name,l.ext)];throw"不支持的QQ音乐缓存格式"}return d=new Blob([a],{type:c["a"][u]}),[4,Object(s["parseBlob"])(d)];case 4:return f=n.sent(),b=Object(c["f"])(e,f.common.title,String(f.common.artists||f.common.artist||"")),m=b.title,p=b.artist,[2,{title:m,artist:p,ext:u,album:f.common.album,picture:Object(c["d"])(f),file:URL.createObjectURL(d),blob:d,mime:c["a"][u]}]}}))}))}var x=r("8866"),_=r.n(x),k=2097152;function A(t,e){return Object(n["a"])(this,void 0,Promise,(function(){var r,i,a,c,s,o,u,l,d,f,b,m;return Object(n["c"])(this,(function(n){switch(n.label){case 0:r={success:!1,data:new Uint8Array,error:""},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,_()()];case 2:return i=n.sent(),[3,4];case 3:return a=n.sent(),r.error=(null===a||void 0===a?void 0:a.message)||"wasm 加载失败",[2,r];case 4:if(!i)return r.error="wasm 加载失败",[2,r];c=new Uint8Array(t),s=i._malloc(k),o=Math.min(k,t.byteLength),i.writeArrayToMemory(c.slice(0,o),s),u=i.preDec(s,o,e),c=c.slice(u),l=[],d=0,f=c.length;while(f>0)b=Math.min(f,k),m=new Uint8Array(c.slice(d,d+b)),i.writeArrayToMemory(m,s),i.decBlob(s,b,d),l.push(i.HEAPU8.slice(s,s+b)),d+=b,f-=b;return i._free(s),r.data=v(l),r.success=!0,[2,r]}}))}))}var U=[5,40,188,150,233,228,90,67,145,170,189,208,122,245,54,49],T=[124,213,50,235,134,2,127,75,168,175,166,142,15,255,153,20];function P(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,o,u,l,d,f,b,m,p;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,Object(c["c"])(t)];case 1:if(i=n.sent(),"vpr"===r){if(!Object(c["b"])(new Uint8Array(i),U))throw Error("Not a valid vpr file!")}else if(!Object(c["b"])(new Uint8Array(i),T))throw Error("Not a valid kgm(a) file!");return a=new Uint8Array,globalThis.WebAssembly?[4,A(i,r)]:[3,3];case 2:if(o=n.sent(),!o.success)throw new Error(o.error||"(unknown error)");a=o.data,console.log("kgm wasm decoder suceeded"),n.label=3;case 3:return u=Object(c["i"])(a),l=c["a"][u],d=new Blob([a],{type:l}),[4,Object(s["parseBlob"])(d)];case 4:return f=n.sent(),b=Object(c["f"])(e,f.common.title,String(f.common.artists||f.common.artist||"")),m=b.title,p=b.artist,[2,{album:f.common.album,picture:Object(c["d"])(f),file:URL.createObjectURL(d),blob:d,ext:u,mime:l,title:m,artist:p}]}}))}))}r("25f0"),r("843c");var E=[121,101,101,108,105,111,110,45,107,117,119,111,45,116,109,101],D=[121,101,101,108,105,111,110,45,107,117,119,111,0,0,0,0],L="MoOtOiTvINGwd2E6n0E1i7L5t2IoOoNk";function C(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var r,i,a,o,l,d,f,b,m,p,v,h,g,w;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return i=Uint8Array.bind,[4,Object(c["c"])(t)];case 1:return r=new(i.apply(Uint8Array,[void 0,n.sent()])),Object(c["b"])(r,E)||Object(c["b"])(r,D)?[3,4]:"aac"!==Object(c["i"])(r)?[3,3]:[4,Object(u["a"])(t,e,"aac",!1)];case 2:return[2,n.sent()];case 3:throw Error("not a valid kwm file");case 4:for(a=r.slice(24,32),o=F(a),l=r.slice(1024),d=l.length,f=0;f<d;++f)l[f]^=o[f%32];return b=Object(c["i"])(l),m=c["a"][b],p=new Blob([l],{type:m}),[4,Object(s["parseBlob"])(p)];case 5:return v=n.sent(),h=Object(c["f"])(e,v.common.title,String(v.common.artists||v.common.artist||"")),g=h.title,w=h.artist,[2,{album:v.common.album,picture:Object(c["d"])(v),file:URL.createObjectURL(p),blob:p,mime:m,title:g,artist:w,ext:b}]}}))}))}function F(t){for(var e=new DataView(t.buffer),r=e.getBigUint64(0,!0).toString(),n=S(r),i=new Uint8Array(32),a=0;a<32;a++)i[a]=L.charCodeAt(a)^n.charCodeAt(a);return i}function S(t){var e=t.length,r=t;return e>32?r=t.slice(0,32):e<32&&(r=t.padEnd(32,t)),r}var B=[0,0,0,32,102,116,121,112];function R(t,e){return Object(n["a"])(this,void 0,Promise,(function(){var r,i,a,s;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return i=Uint8Array.bind,[4,Object(c["c"])(t)];case 1:for(r=new(i.apply(Uint8Array,[void 0,n.sent()])),a=0;a<8;++a)r[a]=B[a];return s=new Blob([r],{type:"audio/mp4"}),[4,Object(u["a"])(s,e,"m4a",!1)];case 2:return[2,n.sent()]}}))}))}r("ac1f"),r("466d");var I=r("dc71"),M=r.n(I),q=r("b7c7");function N(t,e,r){var i;return Object(n["a"])(this,void 0,Promise,(function(){var r,a,s,o,u,l,d,f,b,m,p,h,g,j;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return[4,q["a"].loadJooxUUID("")];case 1:if(r=n.sent(),!r||32!==r.length)throw new Error("请在“解密设定”填写应用 Joox 应用的 UUID。");return s=Uint8Array.bind,[4,Object(c["c"])(t)];case 2:if(a=new(s.apply(Uint8Array,[void 0,n.sent()])),o=M()(a,r),!o)throw new Error("不支持的 joox 加密格式");return u=v(o.decryptFile(a)),l=Object(c["i"])(u),d=c["a"][l],f=null===(i=e.match(/^(\d+)\s\[mqms\d*]$/i))||void 0===i?void 0:i[1],[4,Object(w["a"])(new Blob([u],{type:d}),e,l,f)];case 3:return b=n.sent(),m=b.album,p=b.artist,h=b.imgUrl,g=b.blob,j=b.title,[2,{title:j,artist:p,ext:l,album:m,picture:h,file:URL.createObjectURL(g),blob:g,mime:d}]}}))}))}r("4ec9");var $=new Map([["x2m",W],["x3m",H]]);function J(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var i,a,o,u,l,d,f,b,m;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return a=Uint8Array.bind,[4,Object(c["c"])(t)];case 1:if(i=new(a.apply(Uint8Array,[void 0,n.sent()])),o=$.get(r),!o)throw"File type is incorrect!";return u=o(i),l=Object(c["i"])(u,"m4a"),d=c["a"][l],f=new Blob([u],{type:d}),[4,Object(s["parseBlob"])(f)];case 2:return b=n.sent(),m=Object(c["f"])(e,b.common.title,b.common.artist),[2,{picture:"",title:m.title,artist:m.artist,ext:l,album:b.common.album,blob:f,file:URL.createObjectURL(f),mime:d}]}}))}))}function W(t){for(var e=1024,r=[120,109,108,121],n=t.slice(0,e),i=0;i<e;i++){var a=G[i];t[i]=n[a]^r[i%r.length]}return t}function H(t){for(var e=1024,r=[51,57,56,57,100,49,49,49,97,97,100,53,54,49,51,57,52,48,102,52,102,99,52,52,98,54,51,57,98,50,57,50],n=t.slice(0,e),i=0;i<e;i++){var a=Q[i];t[i]=n[a]^r[i%r.length]}return t}var G=[681,683,340,682,680,684,339,679,685,338,678,1023,0,341,686,337,677,1022,1,342,687,336,676,1021,2,343,688,335,675,1020,3,344,689,334,674,1019,4,345,690,333,673,1018,5,346,691,332,672,1017,6,347,692,331,671,1016,7,348,693,330,670,1015,8,349,694,329,669,1014,9,350,695,328,668,1013,10,351,696,327,667,1012,11,352,697,326,666,1011,12,353,698,325,665,1010,13,354,699,324,664,1009,14,355,700,323,663,1008,15,356,701,322,662,1007,16,357,702,321,661,1006,17,358,703,320,660,1005,18,359,704,319,659,1004,19,360,705,318,658,1003,20,361,706,317,657,1002,21,362,707,316,656,1001,22,363,708,315,655,1e3,23,364,709,314,654,999,24,365,710,313,653,998,25,366,711,312,652,997,26,367,712,311,651,996,27,368,713,310,650,995,28,369,714,309,649,994,29,370,715,308,648,993,30,371,716,307,647,992,31,372,717,169,510,855,32,373,718,170,511,856,33,374,719,171,512,857,34,375,720,172,513,858,35,376,721,173,514,859,36,377,722,174,515,860,37,378,723,175,516,861,38,379,724,176,517,862,39,380,725,177,518,863,40,381,726,178,519,864,41,382,727,179,520,865,42,383,728,180,521,866,43,384,729,181,522,867,44,385,730,182,523,868,45,386,731,183,524,869,46,387,732,184,525,870,47,388,733,185,526,871,48,389,734,186,527,872,49,390,735,187,528,873,50,391,736,188,529,874,51,392,737,189,530,875,52,393,738,190,531,876,53,394,739,191,532,877,54,395,740,192,533,878,55,396,741,193,534,879,56,397,742,194,535,880,57,398,743,195,536,881,58,399,744,196,537,882,59,400,745,197,538,883,60,401,746,198,539,884,61,402,747,199,540,885,62,403,748,200,541,886,63,404,749,201,542,887,64,405,750,202,543,888,65,406,751,203,544,889,66,407,752,204,545,890,67,408,753,205,546,891,68,409,754,206,547,892,69,410,755,207,548,893,70,411,756,208,549,894,71,412,757,209,550,895,72,413,758,210,551,896,73,414,759,211,552,897,74,415,760,212,553,898,75,416,761,213,554,899,76,417,762,214,555,900,77,418,763,215,556,901,78,419,764,216,557,902,79,420,765,217,558,903,80,421,766,218,559,904,81,422,767,219,560,905,82,423,768,220,561,906,83,424,769,221,562,907,84,425,770,222,563,908,85,426,771,223,564,909,86,427,772,224,565,910,87,428,773,225,566,911,88,429,774,226,567,912,89,430,775,227,568,913,90,431,776,228,569,914,91,432,777,229,570,915,92,433,778,230,571,916,93,434,779,231,572,917,94,435,780,232,573,918,95,436,781,233,574,919,96,437,782,234,575,920,97,438,783,235,576,921,98,439,784,236,577,922,99,440,785,237,578,923,100,441,786,238,579,924,101,442,787,239,580,925,102,443,788,240,581,926,103,444,789,241,582,927,104,445,790,242,583,928,105,446,791,243,584,929,106,447,792,244,585,930,107,448,793,245,586,931,108,449,794,246,587,932,109,450,795,247,588,933,110,451,796,248,589,934,111,452,797,249,590,935,112,453,798,250,591,936,113,454,799,251,592,937,114,455,800,252,593,938,115,456,801,253,594,939,116,457,802,254,595,940,117,458,803,255,596,941,118,459,804,256,597,942,119,460,805,257,598,943,120,461,806,258,599,944,121,462,807,259,600,945,122,463,808,260,601,946,123,464,809,261,602,947,124,465,810,262,603,948,125,466,811,263,604,949,126,467,812,264,605,950,127,468,813,265,606,951,128,469,814,266,607,952,129,470,815,267,608,953,130,471,816,268,609,954,131,472,817,269,610,955,132,473,818,270,611,956,133,474,819,271,612,957,134,475,820,272,613,958,135,476,821,273,614,959,136,477,822,274,615,960,137,478,823,275,616,961,138,479,824,276,617,962,139,480,825,277,618,963,140,481,826,278,619,964,141,482,827,279,620,965,142,483,828,280,621,966,143,484,829,281,622,967,144,485,830,282,623,968,145,486,831,283,624,969,146,487,832,284,625,970,147,488,833,285,626,971,148,489,834,286,627,972,149,490,835,287,628,973,150,491,836,288,629,974,151,492,837,289,630,975,152,493,838,290,631,976,153,494,839,291,632,977,154,495,840,292,633,978,155,496,841,293,634,979,156,497,842,294,635,980,157,498,843,295,636,981,158,499,844,296,637,982,159,500,845,297,638,983,160,501,846,298,639,984,161,502,847,299,640,985,162,503,848,300,641,986,163,504,849,301,642,987,164,505,850,302,643,988,165,506,851,303,644,989,166,507,852,304,645,990,167,508,853,305,646,991,168,509,854,306],Q=[598,653,531,775,342,925,98,368,970,53,237,676,484,857,211,619,613,628,593,663,514,802,294,811,279,770,348,936,87,328,896,144,502,821,268,750,373,980,43,204,608,635,573,699,438,929,94,343,926,97,367,966,57,247,697,440,927,96,358,953,70,290,796,303,829,252,714,420,972,51,230,659,521,789,317,856,213,622,606,637,570,704,433,943,80,310,838,239,682,462,886,160,528,780,332,905,130,475,871,185,574,698,439,928,95,356,951,72,293,806,284,778,335,911,112,424,967,56,245,693,445,915,108,409,993,30,179,559,727,403,1002,21,157,522,788,318,858,210,618,615,626,595,660,520,793,311,844,231,661,517,797,302,828,254,717,416,981,42,200,600,646,554,732,398,1015,8,124,467,880,167,541,753,369,973,50,229,658,523,787,319,860,208,614,627,594,662,516,799,298,818,271,756,364,963,60,257,722,410,992,31,181,563,713,422,969,54,240,683,459,892,149,509,808,282,774,344,930,93,341,924,99,372,979,44,207,612,629,591,665,506,812,277,767,351,939,84,323,876,173,549,741,385,1007,16,140,497,836,243,687,452,902,136,483,859,209,617,616,621,607,636,571,703,434,942,81,315,853,218,632,584,678,476,869,192,582,680,470,877,172,548,744,382,1003,20,156,519,794,307,833,248,700,437,931,92,338,917,106,396,1017,6,122,465,883,164,535,766,352,941,82,316,855,215,624,604,641,565,710,426,956,67,285,781,330,900,138,487,851,221,644,558,728,402,1004,19,153,513,803,292,801,295,813,276,765,353,944,79,309,835,244,692,446,914,109,413,987,36,190,580,688,450,906,128,473,873,182,564,712,423,968,55,241,685,454,899,141,498,827,256,721,411,990,33,187,576,694,443,921,102,378,991,32,184,572,701,436,933,90,336,912,111,421,971,52,234,669,494,840,236,675,485,854,216,625,599,649,544,748,376,985,38,194,587,673,490,845,228,657,524,786,321,864,202,602,643,560,720,412,989,34,188,577,691,447,913,110,418,977,46,214,623,605,639,567,708,428,954,69,289,792,312,846,227,655,529,779,333,908,115,451,903,132,479,866,199,597,654,530,777,339,918,105,395,1018,5,121,464,884,162,533,769,349,937,86,327,890,152,512,804,287,790,314,850,223,648,547,745,381,1001,22,158,525,784,324,882,165,537,762,357,952,71,291,798,301,824,263,736,392,1022,1,117,457,894,147,505,815,274,761,359,958,65,267,743,383,1005,18,151,511,805,286,785,322,870,186,575,696,441,923,100,374,982,41,197,592,664,508,809,281,772,346,934,89,334,910,113,429,950,73,296,814,275,764,354,946,77,305,831,250,706,431,947,76,304,830,251,711,425,957,66,278,768,350,938,85,326,888,155,518,795,306,832,249,702,435,940,83,320,861,206,610,633,583,679,471,875,174,550,739,389,1014,9,125,468,879,168,542,752,370,974,49,222,647,552,735,393,1021,2,118,458,893,148,507,810,280,771,347,935,88,331,904,131,477,868,193,586,674,489,848,225,651,538,760,360,959,64,266,742,384,1006,17,145,503,820,269,751,371,975,48,220,640,566,709,427,955,68,288,791,313,847,226,652,536,763,355,948,75,300,823,264,738,390,1020,3,119,460,891,150,510,807,283,776,340,919,104,387,1011,12,133,480,865,201,601,645,556,730,400,1010,13,134,481,863,203,603,642,562,716,417,978,45,212,620,611,631,585,677,478,867,198,596,656,526,783,325,887,159,527,782,329,898,142,499,826,258,723,408,994,29,178,557,729,401,1009,14,135,482,862,205,609,634,579,689,449,907,127,472,874,180,561,719,414,986,37,191,581,684,455,897,143,501,822,265,740,388,1012,11,129,474,872,183,569,705,432,945,78,308,834,246,695,442,922,101,377,988,35,189,578,690,448,909,114,444,920,103,386,1008,15,139,488,849,224,650,540,755,365,964,59,255,718,415,983,40,196,590,667,496,837,242,686,453,901,137,486,852,219,638,568,707,430,949,74,299,819,270,754,366,965,58,253,715,419,976,47,217,630,588,671,492,842,233,668,495,839,238,681,463,885,161,532,773,345,932,91,337,916,107,406,998,25,171,546,746,380,997,26,175,551,737,391,1023,0,116,456,895,146,504,817,272,758,362,961,62,260,725,405,999,24,170,545,747,379,996,27,176,553,733,397,1016,7,123,466,881,166,539,757,363,962,61,259,724,407,995,28,177,555,731,399,1013,10,126,469,878,169,543,749,375,984,39,195,589,670,493,841,235,672,491,843,232,666,500,825,262,734,394,1019,4,120,461,889,154,515,800,297,816,273,759,361,960,63,261,726,404,1e3,23,163,534],z=r("efc0");function V(t,e){return Object(n["a"])(this,void 0,Promise,(function(){var r,s,l;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return q["a"]instanceof z["a"]?[4,q["a"].setAll(e)]:[3,2];case 1:n.sent(),n.label=2;case 2:switch(r=Object(c["j"])(t.name),l=r.ext,l){case"mg3d":return[3,3];case"ncm":return[3,5];case"uc":return[3,7];case"kwm":return[3,9];case"xm":return[3,11];case"wav":return[3,11];case"mp3":return[3,11];case"flac":return[3,11];case"m4a":return[3,11];case"ogg":return[3,13];case"tm0":return[3,15];case"tm3":return[3,15];case"qmc0":return[3,17];case"qmc3":return[3,17];case"qmc2":return[3,17];case"qmc4":return[3,17];case"qmc6":return[3,17];case"qmc8":return[3,17];case"qmcflac":return[3,17];case"qmcogg":return[3,17];case"tkm":return[3,17];case"bkcmp3":return[3,17];case"bkcm4a":return[3,17];case"bkcflac":return[3,17];case"bkcwav":return[3,17];case"bkcape":return[3,17];case"bkcogg":return[3,17];case"bkcwma":return[3,17];case"mggl":return[3,17];case"mflac":return[3,17];case"mflac0":return[3,17];case"mflach":return[3,17];case"mgg":return[3,17];case"mgg1":return[3,17];case"mgg0":return[3,17];case"mmp4":return[3,17];case"666c6163":return[3,17];case"6d7033":return[3,17];case"6f6767":return[3,17];case"6d3461":return[3,17];case"776176":return[3,17];case"tm2":return[3,19];case"tm6":return[3,19];case"cache":return[3,21];case"vpr":return[3,23];case"kgm":return[3,23];case"kgma":return[3,23];case"ofl_en":return[3,25];case"x2m":return[3,27];case"x3m":return[3,27];case"mflach":return[3,29]}return[3,30];case 3:return[4,Object(i["a"])(t.raw,r.name)];case 4:return s=n.sent(),[3,31];case 5:return[4,Object(a["a"])(t.raw,r.name,r.ext)];case 6:return s=n.sent(),[3,31];case 7:return[4,o(t.raw,r.name,r.ext)];case 8:return s=n.sent(),[3,31];case 9:return[4,C(t.raw,r.name,r.ext)];case 10:return s=n.sent(),[3,31];case 11:return[4,b(t.raw,r.name,r.ext)];case 12:return s=n.sent(),[3,31];case 13:return[4,Object(u["a"])(t.raw,r.name,r.ext)];case 14:return s=n.sent(),[3,31];case 15:return[4,Object(u["a"])(t.raw,r.name,"mp3")];case 16:return s=n.sent(),[3,31];case 17:return[4,y(t.raw,r.name,r.ext)];case 18:return s=n.sent(),[3,31];case 19:return[4,R(t.raw,r.name)];case 20:return s=n.sent(),[3,31];case 21:return[4,O(t.raw,r.name,r.ext)];case 22:return s=n.sent(),[3,31];case 23:return[4,P(t.raw,r.name,r.ext)];case 24:return s=n.sent(),[3,31];case 25:return[4,N(t.raw,r.name,r.ext)];case 26:return s=n.sent(),[3,31];case 27:return[4,J(t.raw,r.name,r.ext)];case 28:return s=n.sent(),[3,31];case 29:throw'网页版无法解锁，请使用<a target="_blank" href="https://git.unlock-music.dev/um/cli">CLI版本</a>';case 30:throw"不支持此文件格式";case 31:return s.rawExt||(s.rawExt=r.ext),s.rawFilename||(s.rawFilename=r.name),console.log(s),[2,s]}}))}))}},6:function(t,e){},"675e":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n="um.conf.",i="".concat(n,"joox.uuid"),a=function(){function t(){}return t.prototype.saveJooxUUID=function(t){return this.save(i,t)},t.prototype.loadJooxUUID=function(t){return void 0===t&&(t=""),this.load(i,t)},t}();e["b"]=a},"6d95":function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return k}));r("d3b7"),r("ace4"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("986a"),r("1d02"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("6ce5"),r("2834"),r("72f7"),r("4ea1"),r("d9e2"),r("d81d"),r("fb6a"),r("ddb0"),r("25f0"),r("b64b"),r("ac1f"),r("5319"),r("14d9"),r("159b"),r("4de4"),r("498a"),r("a15b"),r("3ca3"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494");var n=r("9ab4"),i=r("cc74"),a=r("cb96"),c=r("0443"),s=r.n(c),o=r("c198"),u=r.n(o),l=r("ead9"),d=r.n(l),f=r("81bf"),b=r.n(f),m=r("17e1"),p=r.n(m),v=r("1132"),h=r.n(v),g=r("f8d5"),w=r.n(g),j=r("640f"),y=r.n(j),O=y.a.parse("687a4852416d736f356b496e62617857"),x=y.a.parse("2331346C6A6B5F215C5D2630553C2728"),_=[67,84,69,78,70,68,65,77];function k(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var r;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return r=A.bind,[4,Object(i["c"])(t)];case 1:return[2,(new(r.apply(A,[void 0,n.sent(),e]))).decrypt()]}}))}))}var A=function(){function e(t,e){this.offset=0,this.format="",this.mime="";var r=new Uint8Array(t,0,8);if(!Object(i["b"])(r,_))throw Error("此ncm文件已损坏");this.offset=10,this.raw=t,this.view=new DataView(t),this.filename=e}return e.prototype._getKeyData=function(){var t=this.view.getUint32(this.offset,!0);this.offset+=4;var e=new Uint8Array(this.raw,this.offset,t).map((function(t){return 100^t}));this.offset+=t;for(var r=u.a.decrypt({ciphertext:p.a.create(e)},O,{mode:b.a,padding:d.a}),n=new Uint8Array(r.sigBytes),i=r.words,a=r.sigBytes,c=0;c<a;c++)n[c]=i[c>>>2]>>>24-c%4*8&255;return n.slice(17)},e.prototype._getKeyBox=function(){for(var t,e=this._getKeyData(),r=new Uint8Array(Array(256).keys()),n=e.length,i=0,a=0;a<256;a++)i=r[a]+i+e[a%n]&255,t=[r[i],r[a]],r[a]=t[0],r[i]=t[1];return r.map((function(t,e,r){e=e+1&255;var n=r[e],i=r[e+n&255];return r[n+i&255]}))},e.prototype._getMetaData=function(){var t=this.view.getUint32(this.offset,!0);if(this.offset+=4,0===t)return{};var e=new Uint8Array(this.raw,this.offset,t).map((function(t){return 99^t}));this.offset+=t,p.a.create();var r,n=u.a.decrypt({ciphertext:h.a.parse(p.a.create(e.slice(22)).toString(w.a))},x,{mode:b.a,padding:d.a}).toString(w.a),i=n.indexOf(":");if("dj"===n.slice(0,i)){var a=JSON.parse(n.slice(i+1));r=a.mainMusic}else r=JSON.parse(n.slice(i+1));return r.albumPic&&(r.albumPic=r.albumPic.replace("http://","https://")+"?param=500y500"),r},e.prototype._getAudio=function(t){this.offset+=this.view.getUint32(this.offset+5,!0)+13;for(var e=new Uint8Array(this.raw,this.offset),r=e.length,n=0;n<r;++n)e[n]^=t[255&n];return e},e.prototype._buildMeta=function(){var e;return Object(n["a"])(this,void 0,void 0,(function(){var r,a,c,o,u,l;return Object(n["c"])(this,(function(n){switch(n.label){case 0:if(!this.oriMeta)throw Error("invalid sequence");if(r=Object(i["f"])(this.filename,this.oriMeta.musicName),a=[],"string"===typeof this.oriMeta.artist?a.push(this.oriMeta.artist):Array.isArray(this.oriMeta.artist)&&this.oriMeta.artist.forEach((function(t){"string"===typeof t?a.push(t):Array.isArray(t)&&t[0]&&"string"===typeof t[0]&&a.push(t[0])})),0===a.length&&r.artist&&(a=r.artist.split(",").map((function(t){return t.trim()})).filter((function(t){return""!=t}))),!this.oriMeta.albumPic)return[3,9];n.label=1;case 1:return n.trys.push([1,8,,9]),c=this,[4,Object(i["e"])(this.oriMeta.albumPic)];case 2:c.image=n.sent(),n.label=3;case 3:return this.image&&this.image.buffer.byteLength>=1<<24?[4,s.a.read(t.from(this.image.buffer))]:[3,7];case 4:return o=n.sent(),[4,o.resize(Math.round(o.getHeight()/2),s.a.AUTO)];case 5:return n.sent(),u=this.image,[4,o.getBufferAsync("image/jpeg")];case 6:return u.buffer=n.sent(),[3,3];case 7:return[3,9];case 8:return l=n.sent(),console.log("fetch cover image failed",l),[3,9];case 9:return this.newMeta={title:r.title,artists:a,album:this.oriMeta.album,picture:null===(e=this.image)||void 0===e?void 0:e.buffer},[2]}}))}))},e.prototype._writeMeta=function(){return Object(n["a"])(this,void 0,void 0,(function(){var e,r;return Object(n["c"])(this,(function(n){switch(n.label){case 0:if(!this.audio||!this.newMeta)throw Error("invalid sequence");return this.blob||(this.blob=new Blob([this.audio],{type:this.mime})),[4,Object(a["parseBlob"])(this.blob)];case 1:if(e=n.sent(),r=!e.common.album&&!e.common.artists&&!e.common.title,r||this.newMeta.picture){if("mp3"===this.format)this.audio=Object(i["l"])(t.from(this.audio),this.newMeta,e);else{if("flac"!==this.format)return console.info("writing meta for ".concat(this.format," is not being supported for now")),[2];this.audio=Object(i["k"])(t.from(this.audio),this.newMeta,e)}this.blob=new Blob([this.audio],{type:this.mime})}return[2]}}))}))},e.prototype.gatherResult=function(){var t,e;if(!this.newMeta||!this.blob)throw Error("bad sequence");return{title:this.newMeta.title,artist:null===(t=this.newMeta.artists)||void 0===t?void 0:t.join("; "),ext:this.format,album:this.newMeta.album,picture:null===(e=this.image)||void 0===e?void 0:e.url,file:URL.createObjectURL(this.blob),blob:this.blob,mime:this.mime}},e.prototype.decrypt=function(){return Object(n["a"])(this,void 0,void 0,(function(){var t,e;return Object(n["c"])(this,(function(r){switch(r.label){case 0:t=this._getKeyBox(),this.oriMeta=this._getMetaData(),this.audio=this._getAudio(t),this.format=this.oriMeta.format||Object(i["i"])(this.audio),this.mime=i["a"][this.format],r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this._buildMeta()];case 2:return r.sent(),[4,this._writeMeta()];case 3:return r.sent(),[3,5];case 4:return e=r.sent(),console.warn("build/write meta failed, skip.",e),[3,5];case 5:return[2,this.gatherResult()]}}))}))},e}()}).call(this,r("1c35").Buffer)},7:function(t,e){},"730d":function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"解密设定",visible:t.show,"custom-class":"um-config-dialog",center:""},on:{close:function(e){return t.cancel()}}},[e("el-form",{ref:"form",attrs:{rules:t.rules,"status-icon":"",model:t.form,"label-width":"0"}},[e("section",[e("label",[e("span",[t._v(" JOOX Music · "),e("Ruby",{attrs:{caption:"Unique Device Identifier"}},[t._v("设备唯一识别码")])],1),e("el-form-item",{attrs:{prop:"jooxUUID"}},[e("el-input",{attrs:{type:"text",clearable:"",maxlength:"32","show-word-limit":""},model:{value:t.form.jooxUUID,callback:function(e){t.$set(t.form,"jooxUUID",e)},expression:"form.jooxUUID"}})],1)],1),e("p",{staticClass:"tip"},[t._v(" 下载该加密文件的 JOOX 应用所记录的设备唯一识别码。 "),e("br"),t._v(" 参见： "),e("a",{attrs:{href:"https://git.unlock-music.dev/um/joox-crypto/wiki/%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87-UUID#%E5%89%8D%E8%A8%80"}},[t._v(" 获取设备 UUID · unlock-music/joox-crypto Wiki")]),t._v("。 ")])])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:function(e){return t.emitConfirm()}}},[t._v("确 定")])],1)],1)},i=[],a=r("c7eb"),c=r("1da1"),s=(r("ac1f"),r("00b4"),r("d9e2"),r("b7c7")),o=r("77b3");function u(t,e,r){e&&/^[\da-fA-F]{32}$/.test(e)?r():r(new Error("无效的 Joox UUID，请参考 Wiki 获取。"))}var l={jooxUUID:{validator:u,trigger:"change"}},d={components:{Ruby:o["a"]},props:{show:{type:Boolean,required:!0}},data:function(){return{rules:l,saving:!1,form:{jooxUUID:""},centerDialogVisible:!1}},mounted:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.resetForm();case 2:case"end":return e.stop()}}),e)})))()},methods:{resetForm:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].loadJooxUUID();case 2:t.form.jooxUUID=e.sent;case 3:case"end":return e.stop()}}),e)})))()},cancel:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.resetForm();case 2:t.$emit("done");case 3:case"end":return e.stop()}}),e)})))()},emitConfirm:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.saving=!0,e.next=3,s["a"].saveJooxUUID(t.form.jooxUUID);case 3:t.saving=!1,t.$emit("done");case 5:case"end":return e.stop()}}),e)})))()}}},f=d,b=(r("8663"),r("2877")),m=Object(b["a"])(f,n,i,!1,null,"670c0e2e",null);e["a"]=m.exports},"73ec":function(t,e,r){"use strict";r.d(e,"e",(function(){return n})),r.d(e,"d",(function(){return a})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"f",(function(){return u})),r.d(e,"a",(function(){return l}));r("99af"),r("14d9"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494"),r("2ca0");var n,i=r("9ab4");(function(t){t[t["ArtistAndTitle"]=0]="ArtistAndTitle",t[t["TitleOnly"]=1]="TitleOnly",t[t["TitleAndArtist"]=2]="TitleAndArtist",t[t["SameAsOriginal"]=3]="SameAsOriginal"})(n||(n={}));var a=[{key:n.ArtistAndTitle,text:"歌手-歌曲名"},{key:n.TitleOnly,text:"歌曲名"},{key:n.TitleAndArtist,text:"歌曲名-歌手"},{key:n.SameAsOriginal,text:"同源文件名"}];function c(t,e){switch(e){case n.TitleOnly:return"".concat(t.title,".").concat(t.ext);case n.TitleAndArtist:return"".concat(t.title," - ").concat(t.artist,".").concat(t.ext);case n.SameAsOriginal:return"".concat(t.rawFilename,".").concat(t.ext);default:case n.ArtistAndTitle:return"".concat(t.artist," - ").concat(t.title,".").concat(t.ext)}}function s(t,e,r){return Object(i["a"])(this,void 0,void 0,(function(){var n,a,s;return Object(i["c"])(this,(function(i){switch(i.label){case 0:n=c(t,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.getFileHandle(n)];case 2:return i.sent(),n="".concat((new Date).getTime()," - ").concat(n),[3,4];case 3:return i.sent(),[3,4];case 4:return[4,r.getFileHandle(n,{create:!0})];case 5:return a=i.sent(),[4,a.createWritable()];case 6:return s=i.sent(),[4,s.write(t.blob)];case 7:return i.sent(),[4,s.close()];case 8:return i.sent(),[2]}}))}))}function o(t,e){var r=document.createElement("a");r.href=t.file,r.download=c(t,e),document.body.append(r),r.click(),r.remove()}function u(t){var e;URL.revokeObjectURL(t.file),(null===(e=t.picture)||void 0===e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(t.picture)}var l=function(){function t(){this.pending=[]}return t.prototype.queue=function(t){this.pending.push(t),this.consume()},t.prototype.consume=function(){var t=this,e=this.pending.shift();e&&e().then((function(){return t.consume})).catch(console.error)},t}()},"77b3":function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("ruby",{attrs:{title:t.caption}},[t._t("default"),e("rp",[t._v("（")]),e("rt",{domProps:{textContent:t._s(t.caption)}}),e("rp",[t._v("）")])],2)},i=[],a={name:"Ruby",props:{caption:{type:String,required:!0}}},c=a,s=r("2877"),o=Object(s["a"])(c,n,i,!1,null,null,null);e["a"]=o.exports},"7c75":function(t,e,r){"use strict";r("985e")},8663:function(t,e,r){"use strict";r("1813")},9224:function(t){t.exports=JSON.parse('{"name":"unlock-music","version":"1.10.6","ext_build":0,"updateInfo":"修正文件过小的情况下酷狗 / QQ解密错误问题","license":"MIT","description":"Unlock encrypted music file in browser.","repository":{"type":"git","url":"https://git.unlock-music.dev/um/web"},"private":true,"scripts":{"postinstall":"patch-package","serve":"vue-cli-service serve","build":"vue-cli-service build","test":"jest","pretty":"prettier --write src/{**/*,*}.{js,ts,jsx,tsx,vue}","pretty:check":"prettier --check src/{**/*,*}.{js,ts,jsx,tsx,vue}","make-extension":"node ./make-extension.js","main":"bash main.sh","deploy":"bash deploy.sh"},"dependencies":{"@babel/preset-typescript":"^7.16.5","@unlock-music/joox-crypto":"^0.0.1-R5","@xhacker/kgmwasm":"^1.0.0","@xhacker/qmcwasm":"^1.0.0","base64-js":"^1.5.1","browser-id3-writer":"^4.4.0","core-js":"^3.16.0","crypto-js":"^4.1.1","element-ui":"^2.15.5","iconv-lite":"^0.6.3","jimp":"^0.16.1","metaflac-js":"^1.0.5","music-metadata":"7.9.0","music-metadata-browser":"2.2.7","register-service-worker":"^1.7.2","threads":"^1.6.5","vue":"^2.6.14"},"devDependencies":{"@types/crypto-js":"^4.0.2","@types/jest":"^27.0.3","@vue/cli-plugin-babel":"^4.5.13","@vue/cli-plugin-pwa":"^4.5.13","@vue/cli-plugin-typescript":"^4.5.13","@vue/cli-service":"^4.5.13","babel-plugin-component":"^1.1.1","jest":"^27.4.5","patch-package":"^6.4.7","prettier":"2.5.1","sass":"^1.38.1","sass-loader":"^10.2.0","semver":"^7.3.5","threads-plugin":"^1.4.0","typescript":"^4.5.4","vue-cli-plugin-element":"^1.0.1","vue-template-compiler":"^2.6.14"}}')},"97e5":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return s})),r.d(e,"b",(function(){return o}));r("d3b7"),r("e9c4"),r("3ca3"),r("ddb0"),r("9861"),r("88a7"),r("271a"),r("5494"),r("99af"),r("25f0"),r("d9e2");var n=r("9ab4"),i="https://um-api.ixarea.com";function a(t){return Object(n["a"])(this,void 0,Promise,(function(){var e;return Object(n["c"])(this,(function(r){switch(r.label){case 0:return[4,fetch(i+"/music/app-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Version:t})})];case 1:return e=r.sent(),[4,e.json()];case 2:return[2,r.sent()]}}))}))}function c(t,e,r){return Object(n["a"])(this,void 0,Promise,(function(){var a,c,s;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return a=i+"/music/qq-cover",c=new URLSearchParams([["Title",t],["Artist",null!==e&&void 0!==e?e:""],["Album",null!==r&&void 0!==r?r:""]]),[4,fetch("".concat(a,"?").concat(c.toString()))];case 1:return s=n.sent(),[4,s.json()];case 2:return[2,n.sent()]}}))}))}function s(t){return Object(n["a"])(this,void 0,Promise,(function(){var e,r;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return e="".concat(i,"/meta/qq-music-raw/").concat(t),[4,fetch(e).then((function(t){return t.json()}))];case 1:if(r=n.sent(),0===r.code&&0===r.req_1.code)return[2,r.req_1.data];throw new Error("请求信息失败")}}))}))}function o(t,e){return void 0===e&&(e=1),"".concat(i,"/music/qq-cover/").concat(e,"/").concat(t)}},"985e":function(t,e,r){},"9b2d":function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return l}));r("d3b7"),r("ace4"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("986a"),r("1d02"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("6ce5"),r("2834"),r("72f7"),r("4ea1"),r("fb6a"),r("caad"),r("14d9"),r("25f0"),r("d9e2");var n=r("9ab4"),i=r("0ba7"),a=r("cc74"),c=32;function s(t){return t>=32&&t<=126}function o(t){return t>=48&&t<=57||t>=65&&t<=70}function u(e,r){for(var n=0;n<e.byteLength;n++)e[n]-=r[n%c];return t.from(e)}function l(e,r){return Object(n["a"])(this,void 0,Promise,(function(){var l,d,f,b,m,p,v,h,g,w,j,y,O,x,_,k;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return d=Uint8Array.bind,[4,Object(a["c"])(e)];case 1:for(l=new(d.apply(Uint8Array,[void 0,n.sent()])),f=l.slice(0,256),b=t.from("RIFF","ascii"),m=t.from("WAVEfmt ","ascii"),p=[],v=c;v<20*c;v+=c)h=l.slice(v,v+c),h.every(o)&&(g=u(f,h),g.slice(0,4).compare(b)||g.slice(8,16).compare(m)||(w=g.readUInt32LE(16),[16,18,40].includes(w)&&(j=20+w,y=g.slice(j,j+4),y.every(s)&&(O=j+8+g.readUInt32LE(j+4),O<=f.byteLength&&(x=g.slice(O,O+4),!x.every(s))||p.push(t.from(h).toString("ascii"))))));if(p.length<=0)throw new Error("ERROR: no suitable key discovered");return _=t.from(p[0],"ascii"),u(l,_),k=new Blob([l],{type:"audio/x-wav"}),[4,Object(i["a"])(k,r,"wav",!1)];case 2:return[2,n.sent()]}}))}))}}).call(this,r("1c35").Buffer)},ab8f:function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-upload",{attrs:{"auto-upload":!1,"on-change":t.addFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或 "),e("em",[t._v("点击选择")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e("div",[t._v(" 仅在浏览器内对文件进行解锁，无需消耗流量 "),e("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("算法在源代码中已经提供，所有运算都发生在本地")]),e("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px"}})])],1),e("div",[t._v(" 工作模式: "+t._s(t.parallel?"多线程 Worker":"单线程 Queue")+" "),e("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 将此工具部署在HTTPS环境下，可以启用Web Worker特性，"),e("br"),t._v(" 从而更快的利用并行处理完成解锁 ")]),e("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px"}})])],1)]),e("transition",{attrs:{name:"el-fade-in"}},[e("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.progress_show,expression:"progress_show"}],staticStyle:{margin:"16px 6px 0 6px"},attrs:{format:t.progress_string,percentage:t.progress_value,"stroke-width":16,"text-inside":!0}})],1)],1)},i=[],a=r("4bc5"),c=a["a"],s=r("2877"),o=Object(s["a"])(c,n,i,!1,null,null,null);e["a"]=o.exports},af85:function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{label:"封面"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:r.row.picture}},[e("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[t._v("暂无封面")])])]}}])}),e("el-table-column",{attrs:{label:"歌曲"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("p",[t._v(t._s(r.row.title))])]}}])}),e("el-table-column",{attrs:{label:"歌手"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("p",[t._v(t._s(r.row.artist))])]}}])}),e("el-table-column",{attrs:{label:"专辑"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("p",[t._v(t._s(r.row.album))])]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(r){return[e("el-button",{attrs:{circle:"",icon:"el-icon-video-play",type:"success"},on:{click:function(e){return t.handlePlay(r.$index,r.row)}}}),e("el-button",{attrs:{circle:"",icon:"el-icon-download"},on:{click:function(e){return t.handleDownload(r.row)}}}),e("el-button",{attrs:{circle:"",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(r.row)}}}),e("el-button",{attrs:{circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(e){return t.handleDelete(r.$index,r.row)}}})]}}])})],1)},i=[],a=(r("a9e3"),r("a434"),r("73ec")),c={name:"PreviewTable",props:{tableData:{type:Array,required:!0},policy:{type:Number,required:!0}},methods:{handlePlay:function(t,e){this.$emit("play",e.file)},handleDelete:function(t,e){Object(a["f"])(e),this.tableData.splice(t,1)},handleDownload:function(t){this.$emit("download",t)},handleEdit:function(t){this.$emit("edit",t)}}},s=c,o=r("2877"),u=Object(o["a"])(s,n,i,!1,null,"8651bfc4",null);e["a"]=u.exports},b7c7:function(t,e,r){"use strict";r.d(e,"a",(function(){return d}));r("d3b7"),r("b64b"),r("e9c4"),r("4fad"),r("2ca0");var n=r("9ab4"),i=r("675e"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n["b"])(e,t),Object.defineProperty(e,"works",{get:function(){return"undefined"!==typeof localStorage&&localStorage.getItem},enumerable:!1,configurable:!0}),e.prototype.load=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){var r;return Object(n["c"])(this,(function(n){if(r=localStorage.getItem(t),null===r)return[2,e];try{return[2,JSON.parse(r)]}catch(i){return[2,e]}return[2]}))}))},e.prototype.save=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(r){return localStorage.setItem(t,JSON.stringify(e)),[2]}))}))},e.prototype.getAll=function(){return Object(n["a"])(this,void 0,Promise,(function(){var t,e,r,a,c,s,o;return Object(n["c"])(this,(function(n){for(t={},e=0,r=Object.entries(localStorage);e<r.length;e++)if(a=r[e],c=a[0],s=a[1],c.startsWith(i["a"]))try{Object.assign(t,(o={},o[c]=JSON.parse(s),o))}catch(u){}return[2,t]}))}))},e.prototype.setAll=function(t){return Object(n["a"])(this,void 0,Promise,(function(){var e,r,i,a,c;return Object(n["c"])(this,(function(n){switch(n.label){case 0:e=0,r=Object.entries(t),n.label=1;case 1:return e<r.length?(i=r[e],a=i[0],c=i[1],[4,this.save(a,c)]):[3,4];case 2:n.sent(),n.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},e}(i["b"]),c=a,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n["b"])(e,t),Object.defineProperty(e,"works",{get:function(){var t,e;return"undefined"!==typeof chrome&&Boolean(null===(e=null===(t=null===chrome||void 0===chrome?void 0:chrome.storage)||void 0===t?void 0:t.local)||void 0===e?void 0:e.set)},enumerable:!1,configurable:!0}),e.prototype.load=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(r){return[2,new Promise((function(r){var n;chrome.storage.local.get((n={},n[t]=e,n),(function(n){Object.prototype.hasOwnProperty.call(n,t)?r(n[t]):r(e)}))}))]}))}))},e.prototype.save=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(r){return[2,new Promise((function(r){var n;chrome.storage.local.set((n={},n[t]=e,n),r)}))]}))}))},e.prototype.getAll=function(){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(t){return[2,new Promise((function(t){chrome.storage.local.get(null,(function(e){for(var r={},n=0,a=Object.entries(e);n<a.length;n++){var c=a[n],s=c[0],o=c[1];s.startsWith(i["a"])&&(r[s]=o)}t(r)}))}))]}))}))},e.prototype.setAll=function(t){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(e){return[2,new Promise((function(e){chrome.storage.local.set(t,e)}))]}))}))},e}(i["b"]),o=s,u=r("efc0");function l(){return o.works?new o:c.works?new c:new u["a"]}var d=l()},c4bc:function(t,e,r){},cc74:function(t,e,r){"use strict";(function(t){r.d(e,"m",(function(){return o})),r.d(e,"a",(function(){return h})),r.d(e,"b",(function(){return g})),r.d(e,"i",(function(){return w})),r.d(e,"c",(function(){return j})),r.d(e,"d",(function(){return y})),r.d(e,"f",(function(){return O})),r.d(e,"e",(function(){return x})),r.d(e,"l",(function(){return _})),r.d(e,"k",(function(){return k})),r.d(e,"h",(function(){return A})),r.d(e,"g",(function(){return U})),r.d(e,"j",(function(){return T}));r("d3b7"),r("fb6a"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494"),r("ac1f"),r("1276"),r("498a"),r("14d9"),r("2ca0"),r("159b"),r("d9e2");var n=r("9ab4"),i=r("7907"),a=r.n(i),c=r("b686"),s=r.n(c),o=/[ ]?[,;/_、][ ]?/,u=[102,76,97,67],l=[73,68,51],d=[79,103,103,83],f=[102,116,121,112],b=[48,38,178,117,142,102,207,17,166,217,0,170,0,98,206,108],m=[82,73,70,70],p=[255,241],v=[70,82,77,56],h={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg",wma:"audio/x-ms-wma",wav:"audio/x-wav",dff:"audio/x-dff"};function g(t,e){return!(e.length>t.length)&&e.every((function(e,r){return e===t[r]}))}function w(t,e){return void 0===e&&(e="mp3"),g(t,l)?"mp3":g(t,u)?"flac":g(t,d)?"ogg":t.length>=4+f.length&&g(t.slice(4),f)?"m4a":g(t,m)?"wav":g(t,b)?"wma":g(t,p)?"aac":g(t,v)?"dff":e}function j(t){return t.arrayBuffer?t.arrayBuffer():new Promise((function(e,r){var n=new FileReader;n.onload=function(t){var n,i=null===(n=t.target)||void 0===n?void 0:n.result;i?e(i):r("read file failed")},n.readAsArrayBuffer(t)}))}function y(t){var e;return(null===(e=t.common)||void 0===e?void 0:e.picture)&&t.common.picture.length>0?URL.createObjectURL(new Blob([t.common.picture[0].data],{type:t.common.picture[0].format})):""}function O(t,e,r,n){void 0===n&&(n="-");var i={title:null!==e&&void 0!==e?e:"",artist:r},a=t.split(n);return a.length>1?((!i.artist||i.artist.split(o).length<a[0].trim().split(o).length)&&(i.artist=a[0].trim()),i.title||(i.title=a[1].trim())):1===a.length&&(i.title||(i.title=a[0].trim())),i}function x(t){return Object(n["a"])(this,void 0,Promise,(function(){var e,r,i,a,c;return Object(n["c"])(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,fetch(t)];case 1:return e=n.sent(),r=e.headers.get("Content-Type"),(null===r||void 0===r?void 0:r.startsWith("image/"))?[4,e.arrayBuffer()]:[3,3];case 2:return i=n.sent(),a=URL.createObjectURL(new Blob([i],{type:r})),[2,{buffer:i,url:a,mime:r}];case 3:return[3,5];case 4:return c=n.sent(),console.warn(c),[3,5];case 5:return[2]}}))}))}function _(t,e,r){var n=new a.a(t),i=r.native["ID3v2.4"]||r.native["ID3v2.3"]||r.native["ID3v2.2"]||[];i.forEach((function(t){if("TPE1"!==t.id&&"TIT2"!==t.id&&"TALB"!==t.id)try{n.setFrame(t.id,t.value)}catch(e){console.warn("failed to write ID3 tag '".concat(t.id,"'"))}}));var c=r.common;return n.setFrame("TPE1",(null===c||void 0===c?void 0:c.artists)||e.artists||[]).setFrame("TIT2",(null===c||void 0===c?void 0:c.title)||e.title).setFrame("TALB",(null===c||void 0===c?void 0:c.album)||e.album||""),e.picture&&n.setFrame("APIC",{type:3,data:e.picture,description:e.picture_desc||""}),n.addTag()}function k(e,r,n){var i=new s.a(e),a=n.common;return a.title||a.album||!a.artists||(i.setTag("TITLE="+r.title),i.setTag("ALBUM="+r.album),r.artists&&(i.removeTag("ARTIST"),r.artists.forEach((function(t){return i.setTag("ARTIST="+t)})))),r.picture&&i.importPictureFromBuffer(t.from(r.picture)),i.save()}function A(t,e,r){var n=new a.a(t),i=r.native["ID3v2.4"]||r.native["ID3v2.3"]||r.native["ID3v2.2"]||[];i.forEach((function(t){if("TPE1"!==t.id&&"TIT2"!==t.id&&"TALB"!==t.id&&"TPE2"!==t.id&&"TCON"!==t.id)try{n.setFrame(t.id,t.value)}catch(e){throw new Error("failed to write ID3 tag '".concat(t.id,"'"))}}));var c=r.common;return n.setFrame("TPE1",(null===e||void 0===e?void 0:e.artists)||c.artists||[]).setFrame("TIT2",(null===e||void 0===e?void 0:e.title)||c.title).setFrame("TALB",(null===e||void 0===e?void 0:e.album)||c.album||"").setFrame("TPE2",(null===e||void 0===e?void 0:e.albumartist)||c.albumartist||"").setFrame("TCON",(null===e||void 0===e?void 0:e.genre)||c.genre||[]),e.picture&&n.setFrame("APIC",{type:3,data:e.picture,description:e.picture_desc||""}),n.addTag()}function U(e,r,n){var i=new s.a(e),a=n.common;return r.title&&(a.title&&i.removeTag("TITLE"),i.setTag("TITLE="+r.title)),r.album&&(a.album&&i.removeTag("ALBUM"),i.setTag("ALBUM="+r.album)),r.albumartist&&(a.albumartist&&i.removeTag("ALBUMARTIST"),i.setTag("ALBUMARTIST="+r.albumartist)),r.artists&&(a.artists&&i.removeTag("ARTIST"),r.artists.forEach((function(t){return i.setTag("ARTIST="+t)}))),r.genre&&(a.genre&&i.removeTag("GENRE"),r.genre.forEach((function(t){return i.setTag("GENRE="+t)}))),r.picture&&i.importPictureFromBuffer(t.from(r.picture)),i.save()}function T(t){var e=t.lastIndexOf(".");return{ext:t.substring(e+1).toLowerCase(),name:t.substring(0,e)}}}).call(this,r("1c35").Buffer)},cd49:function(t,e,r){"use strict";r.r(e);r("9e1f"),r("450d");var n=r("6ed5"),i=r.n(n),a=(r("46a1"),r("e5f2")),c=r.n(a),s=(r("6b30"),r("c284")),o=r.n(s),u=(r("0c67"),r("299c")),l=r.n(u),d=(r("b5d8"),r("f494")),f=r.n(d),b=(r("560b"),r("dcdc")),m=r.n(b),p=(r("f225"),r("89a9")),v=r.n(p),h=(r("f4f9"),r("c2cc")),g=r.n(h),w=(r("7a0f"),r("0f6c")),j=r.n(w),y=(r("aaa5"),r("a578")),O=r.n(y),x=(r("adec"),r("3d2d")),_=r.n(x),k=(r("bdc7"),r("aa2f")),A=r.n(k),U=(r("de31"),r("c69e")),T=r.n(U),P=(r("5466"),r("ecdf")),E=r.n(P),D=(r("38a0"),r("ad41")),L=r.n(D),C=(r("10cb"),r("f3ad")),F=r.n(C),S=(r("eca7"),r("3787")),B=r.n(S),R=(r("425f"),r("4105")),I=r.n(R),M=(r("a7cc"),r("df33")),q=r.n(M),N=(r("1951"),r("eedf")),$=r.n(N),J=(r("acb6"),r("c673")),W=r.n(J),H=(r("fd71"),r("a447")),G=r.n(H),Q=(r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("2b0e")),z=function(){var t=this,e=t._self._c;return e("el-container",{attrs:{id:"app"}},[e("el-main",[e("Home")],1),e("el-footer",{attrs:{id:"app-footer"}},[e("div",[e("a",{attrs:{href:"https://git.unlock-music.dev/um/web",target:"_blank"}},[t._v("音乐解锁")]),t._v("("+t._s(t.version)+") ：移除已购音乐的加密保护。 "),e("a",{attrs:{href:"https://git.unlock-music.dev/um/web/wiki/使用提示",target:"_blank"}},[t._v("使用提示")])]),e("div",[t._v(" 目前支持 网易云音乐(ncm), QQ音乐(qmc, mflac, mgg), 酷狗音乐(kgm), 虾米音乐(xm), 酷我音乐(.kwm) "),e("a",{attrs:{href:"https://git.unlock-music.dev/um/web/src/branch/master/README.md",target:"_blank"}},[t._v("更多")]),t._v("。 ")]),e("div",[e("span",[t._v("Copyright © 2019 - "+t._s((new Date).getFullYear())+" MengYX")]),t._v(" 音乐解锁使用 "),e("a",{attrs:{href:"https://git.unlock-music.dev/um/web/src/branch/master/LICENSE",target:"_blank"}},[t._v("MIT许可协议")]),t._v(" 开放源代码 ")])])],1)},V=[],K=r("c7eb"),X=r("1da1"),Y=(r("99af"),r("ab8f")),Z=r("af85"),tt=r("9224"),et=function(){var t=this,e=t._self._c;return e("div",[e("file-selector",{on:{error:t.showFail,success:t.showSuccess}}),e("div",{attrs:{id:"app-control"}},[e("el-row",{staticClass:"mb-3"},[e("span",[t._v("歌曲命名格式：")]),t._l(t.FilenamePolicies,(function(r){return e("el-radio",{key:r.key,attrs:{label:r.key},model:{value:t.filename_policy,callback:function(e){t.filename_policy=e},expression:"filename_policy"}},[t._v(" "+t._s(r.text)+" ")])}))],2),e("el-row",[e("edit-dialog",{attrs:{show:t.showEditDialog,picture:t.editing_data.picture,title:t.editing_data.title,artist:t.editing_data.artist,album:t.editing_data.album,albumartist:t.editing_data.albumartist,genre:t.editing_data.genre},on:{cancel:function(e){t.showEditDialog=!1},ok:t.handleEdit}}),e("config-dialog",{attrs:{show:t.showConfigDialog},on:{done:function(e){t.showConfigDialog=!1}}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("span",[t._v(" 部分解密方案需要设定解密参数。 ")])]),e("el-button",{attrs:{icon:"el-icon-s-tools",plain:""},on:{click:function(e){t.showConfigDialog=!0}}},[t._v("解密设定")])],1),e("el-button",{attrs:{icon:"el-icon-download",plain:""},on:{click:t.handleDownloadAll}},[t._v("下载全部")]),e("el-button",{attrs:{icon:"el-icon-delete",plain:"",type:"danger"},on:{click:t.handleDeleteAll}},[t._v("清除全部")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t.instant_save?e("span",[t._v("工作模式: "+t._s(t.dir?"写入本地文件系统":"调用浏览器下载"))]):e("span",[t._v(" 当您使用此工具进行大量文件解锁的时候，建议开启此选项。"),e("br"),t._v(" 开启后，解锁结果将不会存留于浏览器中，防止内存不足。 ")])]),e("el-checkbox",{staticClass:"ml-2",attrs:{type:"success",border:""},model:{value:t.instant_save,callback:function(e){t.instant_save=e},expression:"instant_save"}},[t._v("立即保存")])],1)],1)],1),e("audio",{attrs:{autoplay:t.playing_auto,src:t.playing_url,controls:""}}),e("PreviewTable",{staticClass:"table-content",attrs:{policy:t.filename_policy,"table-data":t.tableData},on:{download:t.saveFile,edit:t.editFile,play:t.changePlaying}})],1)},rt=[],nt=r("fc59"),it=nt["a"],at=r("2877"),ct=Object(at["a"])(it,et,rt,!1,null,null,null),st=ct.exports,ot=r("97e5"),ut={name:"app",components:{FileSelector:Y["a"],PreviewTable:Z["a"],Home:st},data:function(){return{version:tt.version}},created:function(){var t=this;this.$nextTick((function(){return t.finishLoad()}))},methods:{finishLoad:function(){var t=this;return Object(X["a"])(Object(K["a"])().mark((function e(){var r,n;return Object(K["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=document.getElementById("loader-mask"),r&&r.remove(),e.prev=2,e.next=5,Object(ot["a"])(t.version);case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),console.warn("check version info failed",e.t0);case 11:n&&(n.HttpsFound||n.Found&&"https:"!==window.location.protocol)?t.$notify.warning({title:"发现更新",message:"发现新版本 v".concat(n.Version,"<br/>更新详情：").concat(n.Detail,'<br/> <a target="_blank" href="').concat(n.URL,'">获取更新</a>'),dangerouslyUseHTMLString:!0,duration:15e3,position:"top-left"}):t.$notify.info({title:"离线使用",message:'<div>\n                        <p>我们使用 PWA 技术，无网络也能使用</p>\n                        <div class="update-info">\n                            <div class="update-title">最近更新</div>\n                            <div class="update-content"> '.concat(tt.updateInfo,' </div>\n                        </div>\n                        <a target="_blank" href="https://git.unlock-music.dev/um/web/wiki/使用提示">使用提示</a>\n                    </div>'),dangerouslyUseHTMLString:!0,duration:1e4,position:"top-left"});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})))()}}},lt=ut,dt=(r("f60c"),Object(at["a"])(lt,z,V,!1,null,null,null)),ft=dt.exports,bt=r("9483");"https:"===window.location.protocol&&Object(bt["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available."),window.location.reload()},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),Q["default"].use(G.a),Q["default"].use(W.a),Q["default"].use($.a),Q["default"].use(q.a),Q["default"].use(I.a),Q["default"].use(B.a),Q["default"].use(F.a),Q["default"].use(L.a),Q["default"].use(E.a),Q["default"].use(T.a),Q["default"].use(A.a),Q["default"].use(_.a),Q["default"].use(O.a),Q["default"].use(j.a),Q["default"].use(g.a),Q["default"].use(v.a),Q["default"].use(m.a),Q["default"].use(f.a),Q["default"].use(l.a),Q["default"].use(o.a),Q["default"].prototype.$notify=c.a,Q["default"].prototype.$confirm=i.a.confirm,Q["default"].config.productionTip=!1,new Q["default"]({render:function(t){return t(ft)}}).$mount("#app")},d4ec:function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"音乐标签编辑",visible:t.show,"custom-class":"um-edit-dialog",center:""},on:{close:function(e){return t.cancel()}}},[e("el-form",{ref:"form",attrs:{"status-icon":"",model:t.form,"label-width":"0"}},[e("section",[e("div",{staticClass:"music-cover"},[e("el-image",{directives:[{name:"show",rawName:"v-show",value:!t.editPicture,expression:"!editPicture"}],attrs:{src:t.imgFile.url||t.picture}},[e("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[t._v("暂无封面")])]),e("el-upload",{directives:[{name:"show",rawName:"v-show",value:t.editPicture,expression:"editPicture"}],attrs:{"auto-upload":!1,"on-change":t.addFile,"on-remove":t.rmvFile,"show-file-list":!0,limit:1,"list-type":"picture",action:"",drag:""}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v("将新图片拖到此处，或"),e("em",[t._v("点击选择")]),e("br"),t._v("以替换自动匹配的图片")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 新拖到此处的图片将覆盖原始图片 ")])]),e("i",{class:{"el-icon-edit":!t.editPicture,"el-icon-check":t.editPicture},on:{click:t.changeCover}})],1),e("div",{staticClass:"edit-item"},[e("div",{staticClass:"label"},[t._v("标题")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.editTitle,expression:"!editTitle"}],staticClass:"value"},[t._v(t._s(t.title))]),e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.editTitle,expression:"editTitle"}],staticClass:"input",attrs:{size:"small"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),e("i",{class:{"el-icon-edit":!t.editTitle,"el-icon-check":t.editTitle},on:{click:function(e){t.editTitle=!t.editTitle}}})],1),e("div",{staticClass:"edit-item"},[e("div",{staticClass:"label"},[t._v("艺术家")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.editArtist,expression:"!editArtist"}],staticClass:"value"},[t._v(t._s(t.artist))]),e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.editArtist,expression:"editArtist"}],staticClass:"input",attrs:{size:"small"},model:{value:t.artist,callback:function(e){t.artist=e},expression:"artist"}}),e("i",{class:{"el-icon-edit":!t.editArtist,"el-icon-check":t.editArtist},on:{click:function(e){t.editArtist=!t.editArtist}}})],1),e("div",{staticClass:"edit-item"},[e("div",{staticClass:"label"},[t._v("专辑")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.editAlbum,expression:"!editAlbum"}],staticClass:"value"},[t._v(t._s(t.album))]),e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.editAlbum,expression:"editAlbum"}],staticClass:"input",attrs:{size:"small"},model:{value:t.album,callback:function(e){t.album=e},expression:"album"}}),e("i",{class:{"el-icon-edit":!t.editAlbum,"el-icon-check":t.editAlbum},on:{click:function(e){t.editAlbum=!t.editAlbum}}})],1),e("div",{staticClass:"edit-item"},[e("div",{staticClass:"label"},[t._v("专辑艺术家")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.editAlbumartist,expression:"!editAlbumartist"}],staticClass:"value"},[t._v(t._s(t.albumartist))]),e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.editAlbumartist,expression:"editAlbumartist"}],staticClass:"input",attrs:{size:"small"},model:{value:t.albumartist,callback:function(e){t.albumartist=e},expression:"albumartist"}}),e("i",{class:{"el-icon-edit":!t.editAlbumartist,"el-icon-check":t.editAlbumartist},on:{click:function(e){t.editAlbumartist=!t.editAlbumartist}}})],1),e("div",{staticClass:"edit-item"},[e("div",{staticClass:"label"},[t._v("风格")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.editGenre,expression:"!editGenre"}],staticClass:"value"},[t._v(t._s(t.genre))]),e("el-input",{directives:[{name:"show",rawName:"v-show",value:t.editGenre,expression:"editGenre"}],staticClass:"input",attrs:{size:"small"},model:{value:t.genre,callback:function(e){t.genre=e},expression:"genre"}}),e("i",{class:{"el-icon-edit":!t.editGenre,"el-icon-check":t.editGenre},on:{click:function(e){t.editGenre=!t.editGenre}}})],1),e("p",{staticClass:"tip"},[t._v(" 为了节省您设备的资源，请在确定前充分检查，避免反复修改。"),e("br"),t._v(" 直接关闭此对话框不会保留所作的更改。 ")])])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.emitConfirm()}}},[t._v("确 定")])],1)],1)},i=[],a=r("c7eb"),c=r("1da1"),s=(r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494"),r("77b3")),o={components:{Ruby:s["a"]},props:{show:{type:Boolean,required:!0},picture:{type:void 0|String,required:!0},title:{type:void 0|String,required:!0},artist:{type:void 0|String,required:!0},album:{type:void 0|String,required:!0},albumartist:{type:void 0|String,required:!0},genre:{type:void 0|String,required:!0}},data:function(){return{form:{},imgFile:{tmpblob:void 0,blob:void 0,url:void 0},editPicture:!1,editTitle:!1,editArtist:!1,editAlbum:!1,editAlbumartist:!1,editGenre:!1}},mounted:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.refreshForm();case 1:case"end":return e.stop()}}),e)})))()},methods:{addFile:function(t){this.imgFile.tmpblob=t.raw},rmvFile:function(){this.imgFile.tmpblob=void 0},changeCover:function(){this.editPicture=!this.editPicture,!this.editPicture&&this.imgFile.tmpblob&&(this.imgFile.blob=this.imgFile.tmpblob,this.imgFile.url&&URL.revokeObjectURL(this.imgFile.url),this.imgFile.url=URL.createObjectURL(this.imgFile.blob))},refreshForm:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.imgFile.url&&URL.revokeObjectURL(t.imgFile.url),t.imgFile={tmpblob:void 0,blob:void 0,url:void 0},t.editPicture=!1,t.editTitle=!1,t.editArtist=!1,t.editAlbum=!1,t.editAlbumartist=!1,t.editGenre=!1;case 8:case"end":return e.stop()}}),e)})))()},cancel:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.refreshForm(),t.$emit("cancel");case 2:case"end":return e.stop()}}),e)})))()},emitConfirm:function(){var t=this;return Object(c["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.editPicture&&t.changeCover(),t.imgFile.url&&URL.revokeObjectURL(t.imgFile.url),t.$emit("ok",{picture:t.imgFile.blob,title:t.title,artist:t.artist,album:t.album,albumartist:t.albumartist,genre:t.genre});case 3:case"end":return e.stop()}}),e)})))()}}},u=o,l=(r("7c75"),r("2877")),d=Object(l["a"])(u,n,i,!1,null,"701d8fe2",null);e["a"]=d.exports},efc0:function(t,e,r){"use strict";r("d3b7"),r("ddb0"),r("4ec9"),r("3ca3"),r("159b"),r("4fad");var n=r("9ab4"),i=r("675e"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.values=new Map,e}return Object(n["b"])(e,t),e.prototype.load=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(r){return this.values.has(t)?[2,this.values.get(t)]:[2,e]}))}))},e.prototype.save=function(t,e){return Object(n["a"])(this,void 0,Promise,(function(){return Object(n["c"])(this,(function(r){return this.values.set(t,e),[2]}))}))},e.prototype.getAll=function(){return Object(n["a"])(this,void 0,Promise,(function(){var t;return Object(n["c"])(this,(function(e){return t={},this.values.forEach((function(e,r){var n;Object.assign(t,(n={},n[r]=e,n))})),[2,t]}))}))},e.prototype.setAll=function(t){return Object(n["a"])(this,void 0,Promise,(function(){var e,r,i,a,c;return Object(n["c"])(this,(function(n){for(e=0,r=Object.entries(t);e<r.length;e++)i=r[e],a=i[0],c=i[1],this.values.set(a,c);return[2]}))}))},e}(i["b"]);e["a"]=a},f60c:function(t,e,r){"use strict";r("c4bc")},fc59:function(t,e,r){"use strict";(function(t){var n=r("c7eb"),i=r("1da1"),a=(r("14d9"),r("e9c4"),r("d3b7"),r("159b"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("88a7"),r("271a"),r("5494"),r("ac1f"),r("1276"),r("25f0"),r("ab8f")),c=r("af85"),s=r("730d"),o=r("d4ec"),u=r("73ec"),l=r("cc74"),d=r("cb96");e["a"]={name:"Home",components:{FileSelector:a["a"],PreviewTable:c["a"],ConfigDialog:s["a"],EditDialog:o["a"]},data:function(){return{showConfigDialog:!1,showEditDialog:!1,editing_data:{picture:"",title:"",artist:"",album:"",albumartist:"",genre:""},tableData:[],playing_url:"",playing_auto:!1,filename_policy:u["e"].ArtistAndTitle,instant_save:!1,FilenamePolicies:u["d"],dir:null}},watch:{instant_save:function(t){t&&this.showDirectlySave()}},methods:{showSuccess:function(t){var e=this;return Object(i["a"])(Object(n["a"])().mark((function r(){var i;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.instant_save){r.next=6;break}return r.next=3,e.saveFile(t);case 3:Object(u["f"])(t),r.next=8;break;case 6:e.tableData.push(t),e.$notify.success({title:"解锁成功",message:"成功解锁 "+t.title,duration:3e3});case 8:i=[t.title,t.artist,t.album],window._paq.push(["trackEvent","Unlock",t.rawExt+","+t.mime,JSON.stringify(i)]);case 9:case"end":return r.stop()}}),r)})))()},showFail:function(t,e){console.error(t,e),this.$notify.error({title:"出现问题",message:t+"，"+e+'，参考<a target="_blank" href="https://git.unlock-music.dev/um/web/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",String(t),e])},changePlaying:function(t){this.playing_url=t,this.playing_auto=!0},handleDeleteAll:function(){this.tableData.forEach((function(t){Object(u["f"])(t)})),this.tableData=[]},handleDecryptionConfig:function(){this.showConfigDialog=!0},handleDownloadAll:function(){var t=this,e=0,r=setInterval((function(){e<t.tableData.length?(t.saveFile(t.tableData[e]),e++):clearInterval(r)}),300)},handleEdit:function(e){var r=this;return Object(i["a"])(Object(n["a"])().mark((function i(){var a,c,s,o,u,f,b,m;return Object(n["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.showEditDialog=!1,URL.revokeObjectURL(r.editing_data.file),e.picture&&(URL.revokeObjectURL(r.editing_data.picture),r.editing_data.picture=URL.createObjectURL(e.picture)),r.editing_data.title=e.title,r.editing_data.artist=e.artist,r.editing_data.album=e.album,a=!0,c="成功修改 "+r.editing_data.title,n.prev=8,n.next=11,Object(d["parseBlob"])(new Blob([r.editing_data.blob],{type:m}));case 11:if(o=n.sent,u=void 0,""===r.editing_data.picture){n.next=18;break}return n.next=16,Object(l["e"])(r.editing_data.picture);case 16:u=n.sent,u||console.warn("获取图像失败",r.editing_data.picture);case 18:return f={picture:null===(s=u)||void 0===s?void 0:s.buffer,title:e.title,artists:e.artist.split(l["m"]),album:e.album,albumartist:e.albumartist,genre:e.genre.split(l["m"])},n.t0=t,n.next=22,r.editing_data.blob.arrayBuffer();case 22:n.t1=n.sent,b=n.t0.from.call(n.t0,n.t1),m=l["a"][r.editing_data.ext]||l["a"].mp3,"mp3"===r.editing_data.ext?r.editing_data.blob=new Blob([Object(l["h"])(b,f,o)],{type:m}):"flac"===r.editing_data.ext?r.editing_data.blob=new Blob([Object(l["g"])(b,f,o)],{type:m}):(a=void 0,c=r.editing_data.ext+"类型文件暂时不支持修改音乐标签"),n.next=32;break;case 28:n.prev=28,n.t2=n["catch"](8),a=!1,c="修改"+r.editing_data.title+"未能完成。在写入新的元数据时发生错误："+n.t2;case 32:r.editing_data.file=URL.createObjectURL(r.editing_data.blob),!0===a?r.$notify.success({title:"修改成功",message:c,duration:3e3}):!1===a?r.$notify.error({title:"修改失败",message:c,duration:3e3}):r.$notify.warning({title:"修改取消",message:c,duration:3e3});case 34:case"end":return n.stop()}}),i,null,[[8,28]])})))()},editFile:function(t){var e=this;return Object(i["a"])(Object(n["a"])().mark((function r(){var i,a;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.editing_data=t,r.next=3,Object(d["parseBlob"])(e.editing_data.blob);case 3:a=r.sent,e.editing_data.albumartist=a.common.albumartist||"",e.editing_data.genre=(null===(i=a.common.genre)||void 0===i?void 0:i.toString())||"",e.showEditDialog=!0;case 7:case"end":return r.stop()}}),r)})))()},saveFile:function(t){var e=this;return Object(i["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.dir){r.next=6;break}return r.next=3,Object(u["b"])(t,e.filename_policy,e.dir);case 3:e.$notify({title:"保存成功",message:t.title,position:"top-left",type:"success",duration:3e3}),r.next=7;break;case 6:Object(u["c"])(t,e.filename_policy);case 7:case"end":return r.stop()}}),r)})))()},showDirectlySave:function(){var t=this;return Object(i["a"])(Object(n["a"])().mark((function e(){var r;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(window.showDirectoryPicker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.$confirm("您的浏览器支持文件直接保存到磁盘，是否使用？","新特性提示",{confirmButtonText:"使用",cancelButtonText:"不使用",type:"warning",center:!0});case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e["catch"](2),console.log(e.t0),e.abrupt("return");case 11:return e.prev=11,e.next=14,window.showDirectoryPicker();case 14:return t.dir=e.sent,r="__unlock_music_write_test.txt",e.next=18,t.dir.getFileHandle(r,{create:!0});case 18:return e.next=20,t.dir.removeEntry(r);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e["catch"](11),console.error(e.t1);case 25:case"end":return e.stop()}}),e,null,[[2,7],[11,22]])})))()}}}}).call(this,r("1c35").Buffer)}});